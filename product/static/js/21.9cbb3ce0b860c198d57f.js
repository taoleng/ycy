webpackJsonp([21],{gK19:function(t,e){},"teX+":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("mvHQ"),s=a.n(n),o=a("gwNS"),r=a("+zM7"),i={data:function(){return{search:{id:"",time:[],key:""},pageIndex:1,TotalCount:0,pageSize:8,tableData:[],info:{total:0,toatlMoney:0,betmoney:0},loading:!0}},created:function(){this.getList()},filters:{time:function(t){return"string"==typeof t?t.substr(0,16):t},orderStatus:function(t){return r.a.orderStatus(t)},settleType:function(t){return r.a.settleType(t)}},methods:{beforeHandleCommand:function(t,e){return{row:t,command:e}},handleCommand:function(t){switch(t.command){case"a":this.handleEdit(t.row);break;case"b":this.payDep(t.row,2);break;case"c":this.payDep(t.row,1);break;case"d":this.cancelOrder(t.row)}},handleEdit:function(t){var e=t.ID,a=this.$router.resolve({path:"/user/detail?id="+e});window.open(a.href,"_blank")},payDep:function(t,e){var a=1==e?t.EarnestMoney:t.BalanceMoney,n={startTime:t.StartTime,money:a,startAddress:t.StartPositionAddress,endAddress:t.EndPostionAddress};localStorage.setItem("LddPayInfo",s()(n)),this.$router.push({path:"pay?id="+encodeURIComponent(t.IdName)+"&m="+a+"&bt="+t.BusinessType+"&ot="+e})},cancelOrder:function(t){var e=this;this.$confirm("您确定要取消该订单吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a={orderId:t.ID},n={Id:t.ID,Remark:null},s=e.$loading({lock:!0,text:"正在取消订单，请稍等...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(o.K)(a).then(function(e){1==e.Code?Object(o.M)(n).then(function(a){s.close(),1==a.Code?t.OrderStatus=5:r.a.toast(e.Msg)}):(s.close(),r.a.toast(e.Msg))})}).catch(function(t){})},change:function(t){this.pageIndex=t,this.getList()},getList:function(){var t=this,e={PageIndex:this.pageIndex,PageSize:this.pageSize,ID:this.search.id,StartTime:"",EndTime:"",Key:this.search.key};this.search.time.length&&(e.StartTime=this.search.time[0],e.EndTime=this.search.time[1]),this.loading=!0,Object(o.q)(e).then(function(e){t.loading=!1,1==e.Code&&(t.info={total:e.TotalCount,toatlMoney:e.DataExpand.TotalMoney,betmoney:e.DataExpand.DebtMoney},t.TotalCount=e.TotalCount,t.tableData=e.Data)})},onSubmit:function(){this.pageIndex=1,this.getList()}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order"},[a("div",{staticClass:"title"},[t._v("综合订单查询")]),t._v(" "),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.search}},[a("el-form-item",{attrs:{label:"订单编号"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"订单编号"},model:{value:t.search.user,callback:function(e){t.$set(t.search,"user",e)},expression:"search.user"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"下单时间"}},[a("el-date-picker",{staticStyle:{width:"250px"},attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},model:{value:t.search.time,callback:function(e){t.$set(t.search,"time",e)},expression:"search.time"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"关键字"}},[a("el-input",{staticStyle:{width:"170px"},attrs:{placeholder:"客企名\\员工名称\\行程"},model:{value:t.search.key,callback:function(e){t.$set(t.search,"key",e)},expression:"search.key"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v("查询")])],1)],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"orderTable"},[a("div",{staticClass:"result"},[t._v("结果汇总：当前数据 "),a("span",{staticClass:"res"},[t._v(t._s(t.info.total))]),t._v(" 条，订单总金额 "),a("span",{staticClass:"res"},[t._v(t._s(t.info.toatlMoney))]),t._v("\n\t\t\t元，下欠款总金额 "),a("span",{staticClass:"res"},[t._v(t._s(t.info.betmoney))]),t._v("\n\t\t\t元")]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-cell-style":{background:"#eef1f6",color:"#606266"}}},[a("el-table-column",{attrs:{type:"expand",width:"30"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form",{staticClass:"demo-table-expand flex flex-wrap",attrs:{"label-position":"left"}},[a("div",{staticClass:"item w1"},[a("div",{staticClass:"item-in"},[a("span",[t._v("包租车：")]),t._v(t._s(e.row.TravelTypeName)+" "+t._s(e.row.TravelFormTypeName))]),t._v(" "),a("div",{staticClass:"item-in"},[a("span",[t._v("下单人：")]),t._v(t._s(e.row.NickName))])]),t._v(" "),a("div",{staticClass:"item w2"},[a("div",{staticClass:"item-in"},[a("span",[t._v("出发时间：")]),t._v(t._s(t._f("time")(e.row.StartTime)))]),t._v(" "),a("div",{staticClass:"item-in"},[a("span",[t._v("达到时间：")]),t._v(t._s(t._f("time")(e.row.EndTime)))])]),t._v(" "),a("div",{staticClass:"item flex-1"},[a("div",{staticClass:"item-in"},[a("span",[t._v("客企名称：")]),t._v(t._s(e.row.EnterpriseName))]),t._v(" "),a("div",{staticClass:"item-in"},[a("span",[t._v("结算状态：")]),a("b",{staticClass:"orderStatus"},[t._v(t._s(t._f("settleType")(e.row.SettleType)))])])])])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"订单号",width:"200",align:"center","tooltip-effect":"dark"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.ID))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"下单时间",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(t._f("time")(e.row.InsertTime)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"行程信息",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.StartPositionCityName)+" → "+t._s(e.row.EndPostionCityName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"包车金额",width:"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.TotalMoney)+" 元")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"定金金额",width:"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.EarnestMoney)+" 元")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"订单状态",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"orderStatus"},[t._v(t._s(t._f("orderStatus")(e.row.OrderStatus)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-dropdown",{on:{command:t.handleCommand}},[a("span",{staticClass:"el-dropdown-link"},[t._v("操作")]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[(3==e.row.OrderStatus||4==e.row.OrderStatus)&&e.row.BalanceMoney>0&&0==e.row.BillType?a("el-dropdown-item",{attrs:{command:t.beforeHandleCommand(e.row,"b")}},[t._v("支付下欠款")]):t._e(),t._v(" "),1==e.row.OrderStatus&&e.row.EarnestMoney>0?a("el-dropdown-item",{attrs:{command:t.beforeHandleCommand(e.row,"c")}},[t._v("支付定金")]):t._e(),t._v(" "),1==e.row.OrderStatus||2==e.row.OrderStatus||6==e.row.OrderStatus?a("el-dropdown-item",{attrs:{command:t.beforeHandleCommand(e.row,"d")}},[t._v("取消订单")]):t._e(),t._v(" "),a("el-dropdown-item",{attrs:{command:t.beforeHandleCommand(e.row,"a")},on:{click:function(a){return t.handleEdit(e.$index,e.row)}}},[t._v("查看详情")])],1)],1)]}}])})],1),t._v(" "),t.TotalCount>8?a("el-pagination",{attrs:{"page-size":t.pageSize,background:"",layout:"prev, pager, next",total:t.TotalCount},on:{"current-change":t.change}}):t._e()],1)],1)},staticRenderFns:[]};var d=a("VU/8")(i,l,!1,function(t){a("gK19")},"data-v-49418988",null);e.default=d.exports}});
//# sourceMappingURL=21.9cbb3ce0b860c198d57f.js.map